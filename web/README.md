# PersonalLM Web Interface

This is an Astro-powered web interface for viewing summaries generated by PersonalLM. It provides a clean, responsive UI for browsing summaries and their associated context data.

## Features

- **Server-rendered** pages using Astro SSR
- **Content Collections** for organizing summaries by date
- **Tailwind CSS v4** with CSS-first styling
- **Archive navigation** with calendar view
- **Context viewer** that decodes `.ctx.br` files on demand
- **Previous/Next navigation** between summaries
- **Responsive design** that works on mobile and desktop
- **Direct Markdown generation** from summary data (no CSV intermediary)

## Directory Structure

```
/web
├── astro.config.mjs       # Astro configuration with Tailwind Vite plugin
├── tsconfig.json          # TypeScript configuration
├── scripts/               # Helper scripts
├── src/
│   ├── components/        # Reusable UI components
│   ├── content/           # Content collections
│   │   └── summaries/     # Summary markdown files (generated)
│   ├── layouts/           # Page layouts
│   ├── pages/             # Page routes
│   │   ├── api/           # API endpoints
│   │   └── archive/       # Archive pages
│   └── styles/            # Global styles with Tailwind CSS
└── public/                # Static assets
```

## Getting Started

1. Install dependencies:
   ```bash
   cd web
   bun install
   ```

2. Start the development server:
   ```bash
   bun run dev
   ```

3. Build for production:
   ```bash
   bun run build
   ```

4. Start the production server:
   ```bash
   bun run start
   ```

## Summary Generation

Summaries are stored as Markdown files in `src/content/summaries/YYYY/MM/`. They are automatically generated from your PersonalLM summaries using the `writeSummaryAsMd` function in `src/utils/writeMarkdown.ts`.

### Direct Markdown Generation

The system uses a direct approach to create Markdown files with YAML front-matter:

1. The `writeSummaryAsMd` function takes summary data and context
2. It writes Markdown files with proper front-matter to `src/content/summaries/YYYY/MM/DD-N.md`
3. It compresses and writes context data to `data/YYYY/MM/DD.ctx.br`
4. The process happens automatically during the build process

Example usage in your aggregator:

```ts
import { writeSummaryAsMd } from '../../src/utils/writeMarkdown.js';

// After generating a summary
await writeSummaryAsMd({
  date: new Date(), 
  index: 1,
  title: "Daily Summary",
  summary: summaryText,
  contextData: contextData
});
```

### Markdown Format

Each Markdown file includes:

```md
---
date: YYYY-MM-DD
index: N
title: "Summary Title"
contextFile: "DD.ctx.br"
---

# Summary Content

Your markdown content here...
```

## Context Files

Context files are stored in the `../data/YYYY/MM/` directory and are:

1. Named `DD.ctx.br`
2. Brotli-compressed JSON files
3. Referenced in each summary's front-matter

The API endpoint `/api/context/YYYY/MM/DD/N` automatically finds, decompresses, and serves these files when requested.

## Integration with PersonalLM

This web interface integrates with your main PersonalLM application by:

1. Reading the markdown summaries from the content collection
2. Accessing context files from the data directory
3. Providing a clean UI for browsing all your summaries

## Tailwind CSS v4 Integration

This project uses Tailwind CSS v4 with the new CSS-first approach:

- No separate config file needed - configuration is done in the CSS
- Uses the Vite plugin via `@tailwindcss/vite`
- Typography plugin is loaded via the `@plugin` directive in CSS

## Customization

- Edit `src/layouts/SummaryLayout.astro` to change the global layout
- Modify styles in `src/styles/global.css` to adjust the theme
- Add additional components as needed 